<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= @model_name %> - <%= @config.app_name %></title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <%= render partial: 'rails_doc_generator/docs/styles' %>
</head>
<body>
  <header class="header">
    <div class="container">
      <div class="header-content">
        <div>
          <h1><%= @config.app_name %></h1>
          <p class="subtitle">API Documentation</p>
        </div>
      </div>
    </div>
  </header>

  <main class="container">
    <div class="breadcrumb">
      <%= link_to "Home", rails_doc_generator.root_path %>
      <span class="breadcrumb-separator">/</span>
      <span class="breadcrumb-current"><%= @model_name %></span>
    </div>

    <div class="stats-grid" style="grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); margin-bottom: 2rem;">
      <div class="stat-card">
        <div class="stat-value"><%= @model.columns.size %></div>
        <div class="stat-label">Columns</div>
      </div>
      <div class="stat-card">
        <div class="stat-value"><%= @model.associations.size %></div>
        <div class="stat-label">Relations</div>
      </div>
      <div class="stat-card">
        <div class="stat-value"><%= @model.validations.size %></div>
        <div class="stat-label">Validations</div>
      </div>
      <div class="stat-card" style="text-align: left; padding: 1.25rem;">
        <div class="stat-label" style="margin-bottom: 0.5rem;">Table</div>
        <code style="font-size: 0.9rem;"><%= @model.table_name || 'N/A' %></code>
      </div>
    </div>

    <!-- Columns -->
    <section class="section">
      <h2 class="section-header">
        Columns
        <span class="section-count"><%= @model.columns.size %></span>
      </h2>
      <% if @model.columns.any? %>
        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>Name</th>
                <th>Type</th>
                <th>Nullable</th>
                <th>Default</th>
              </tr>
            </thead>
            <tbody>
              <% @model.columns.each do |column| %>
                <tr>
                  <td>
                    <code><%= column.name %></code>
                    <% if column.name == @model.primary_key %>
                      <span class="badge badge-post" style="margin-left: 0.5rem;">PK</span>
                    <% end %>
                  </td>
                  <td><span class="type-badge"><%= column.type %></span></td>
                  <td>
                    <% if column.null %>
                      <span style="color: #4ade80;">âœ“ Yes</span>
                    <% else %>
                      <span style="color: #f87171;">âœ— No</span>
                    <% end %>
                  </td>
                  <td>
                    <% if column.default.nil? %>
                      <span style="color: var(--text-dim);">â€”</span>
                    <% else %>
                      <code><%= column.default %></code>
                    <% end %>
                  </td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
      <% else %>
        <div class="empty-state">
          <div class="empty-state-icon">ðŸ“‹</div>
          <p>No columns found</p>
        </div>
      <% end %>
    </section>

    <!-- Associations -->
    <section class="section">
      <h2 class="section-header">
        Associations
        <span class="section-count"><%= @model.associations.size %></span>
      </h2>
      <% if @model.associations.any? %>
        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>Type</th>
                <th>Name</th>
                <th>Related Model</th>
                <th>Foreign Key</th>
              </tr>
            </thead>
            <tbody>
              <% @model.associations.each do |assoc| %>
                <tr>
                  <td>
                    <span class="badge badge-<%= assoc.type.to_s.gsub('_', '-') %>">
                      <%= assoc.type.to_s.gsub('_', ' ') %>
                    </span>
                  </td>
                  <td><code><%= assoc.name %></code></td>
                  <td>
                    <%= link_to assoc.class_name, rails_doc_generator.model_doc_path(name: assoc.class_name), class: "link" %>
                  </td>
                  <td>
                    <% if assoc.foreign_key %>
                      <code><%= assoc.foreign_key %></code>
                    <% else %>
                      <span style="color: var(--text-dim);">â€”</span>
                    <% end %>
                  </td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
      <% else %>
        <div class="empty-state">
          <div class="empty-state-icon">ðŸ”—</div>
          <p>No associations found</p>
        </div>
      <% end %>
    </section>

    <!-- Validations -->
    <% if @model.validations.any? %>
      <section class="section">
        <h2 class="section-header">
          Validations
          <span class="section-count"><%= @model.validations.size %></span>
        </h2>
        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>Attribute</th>
                <th>Validation</th>
                <th>Options</th>
              </tr>
            </thead>
            <tbody>
              <% @model.validations.each do |validation| %>
                <tr>
                  <td><code><%= validation.attribute %></code></td>
                  <td><span class="badge badge-count"><%= validation.kind %></span></td>
                  <td>
                    <% if validation.options.any? %>
                      <% validation.options.each do |key, value| %>
                        <code style="margin-right: 0.5rem;"><%= key %>: <%= value %></code>
                      <% end %>
                    <% else %>
                      <span style="color: var(--text-dim);">â€”</span>
                    <% end %>
                  </td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
      </section>
    <% end %>

    <!-- Scopes -->
    <% if @model.scopes.any? %>
      <section class="section">
        <h2 class="section-header">
          Scopes
          <span class="section-count"><%= @model.scopes.size %></span>
        </h2>
        <div style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
          <% @model.scopes.each do |scope| %>
            <span class="badge badge-count" style="font-size: 0.8125rem; padding: 0.375rem 0.75rem;">
              <%= scope.name %><%= scope.arity != 0 ? "(#{scope.arity > 0 ? scope.arity : '...'})": '' %>
            </span>
          <% end %>
        </div>
      </section>
    <% end %>
  </main>

  <footer class="footer">
    Generated by <a href="https://github.com/your-repo/rails_doc_generator" target="_blank">RailsDocGenerator</a>
  </footer>
</body>
</html>
